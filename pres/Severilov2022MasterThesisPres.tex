\documentclass[10pt,unicode]{beamer}
\usepackage{cmap}
\usepackage[T1, T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage[english, russian]{babel}
\usepackage{amsmath,mathrsfs,amsfonts,amssymb, mathtools}
\usepackage{graphicx, epsfig}



\usepackage{float}
\usepackage[noend]{algorithmic}
\usepackage{subcaption}
\usepackage{tikz}
\usetikzlibrary{matrix}
\input{../doc/newcommands.tex}

\usepackage{multirow}
\captionsetup{labelformat=empty}
\usepackage{wrapfig}


\definecolor{beamer@blendedblue}{RGB}{15,120,80}
\graphicspath{{../figures/}}

\setbeamertemplate{navigation symbols}{}

\mode<presentation>
{
	\usetheme{default}      % or try Darmstadt, Madrid, Warsaw, ...
	\usecolortheme{default} % or try albatross, beaver, crane, ...
	\usefonttheme{default}  % or try serif, structurebold, ...
	\setbeamertemplate{navigation symbols}{}
	\setbeamertemplate{caption}[numbered]
} 
%----------------------------------------------------------------------------------------------------------
\title[]{Выбор оптимальной модели в задаче моделирования динамики физической системы нейронными сетями}
\author{Северилов Павел}
\date{27 апреля 2022г.}
\institute[МФТИ]{Московский физико-технический институт \\
	Кафедра интеллектуальных систем
	\vspace{0.3cm} \\
	Научный руководитель д.ф.-м.н. В.\,В.\,Cтрижов
}

\date{
	Москва,\\
	2022\,г.
}

%----------------------------------------------------------------------------------------------------------
\begin{document}
%----------------------------------------------------------------------------------------------------------
\begin{frame}
\thispagestyle{empty}
\titlepage
\end{frame}
%-----------------------------------------------------------------------------------------------------
\begin{frame}{Введение}
	\textbf{Рассматривается задача} выбора оптимальной модели предсказания динамики физической системы. Под динамикой системы понимается изменение во времени параметров системы. \\ \vspace{0.3cm}
	
	\textbf{Проблема}: Интерпретируемые модели решения задачи разработаны для получения динамики ограниченного набора физических систем, не полностью учитывают физические законы \\ \vspace{0.3cm}

	\textbf{Гипотеза}: Лагранжева нейронная сеть (LNN) является оптимальной моделью в смысле точности и сложности \\ \vspace{0.3cm}
	
	%Актуальность: предполагается, что рассматриваемый подход к декодированию сигналов применим к сигналам с носимых устройств:
	%1 для передискретизации сигнала при низких частотах семплирования
	%2 для обработки нерегулярных по времени данных при непостоянном контакте со считывающим устройством
	
	\textbf{Предлагается:}
	Сгенерировать данные для системы двойного маятника и сравнить моделирование динамики системы моделью LNN и неинтерпретируемыми моделями. \\ \vspace{0.3cm}
	
	\textbf{Новизна:}
	Интерпретация оптимальности модели LNN в терминах симметрии Нётер. Предлагается использование новой модификации LNN, учитывающей иные симметрии кроме закона сохранения энергии.
		
\end{frame}
%-----------------------------------------------------------------------------------------------------
%\begin{frame}{Основные работы}
%	\begin{itemize}
%		\item \textit{Li et al.} Fourier Neural Operator for Parametric Partial Differential Equations, // conference paper at ICLR 2021, 2020
%		\item \textit{Lu et al.} DeepONet: Learning nonlinear operators for identifying differential equations based on the universal approximation theorem of operators, // arXiv preprint arXiv:1910.03193, 2019
%		\item \textit{Kovachki et al.} Neural Operator: Learning Maps Between Function Spaces, //2021
%		\item \textit{Wen et al.} U-FNO -- an enhanced Fourier neural operator based-deep learning model for multiphase flow // arXiv preprint arXiv:2109.03697, 2021
%	\end{itemize}
	
	
%\end{frame}

%-----------------------------------------------------------------------------------------------------
\begin{frame}{Лагранжевы нейронные сети (LNN)}
\begin{itemize}
	\item Вход модели: $x_t = (q_t, \dot{q}_t)$ (канонические координаты)
	\item Требуется получить $\dot{x}_t = (\dot{q}_t, \ddot{q}_t)$
	\item Аппроксимировать нейронной сетью лагранжиан $\mathcal{L}$
	\item Из ограничений Эйлера-Лагранжа получить выражение для обратного распространения ошибки
	$$
	\ddot{q} =\left(\nabla_{\dot{q}} \nabla_{\dot{q}}^{\top} \mathcal{L}\right)^{-1}\left[\nabla_{q} \mathcal{L}-\left(\nabla_{q} \nabla_{\dot{q}}^{\top} \mathcal{L}\right) \dot{q}\right]
	$$ 
	\item \textbf{Функция ошибки}: $$\mathcal{L} = \left\|\dot{x}^{\mathcal{L_{\theta}}}_t -\dot{x}^{true}_t\right\|_{2}$$
\end{itemize}
\end{frame}
%-----------------------------------------------------------------------------------------------------
\begin{frame}{Лагранжевы нейронные сети (LNN)}
	 \begin{figure}[H]
	 	\centering
	 	\begin{subfigure}[b]{0.49\textwidth}
	 		\centering
	 		\includegraphics[width=0.6\textwidth]{baseline_nn_scheme.png}
	 		\caption{Схема работы базового решения моделирования динамики физической системы нейронными сетями}
	 		\label{fig:y equals x}
	 	\end{subfigure}
	 	\hfill
	 	\begin{subfigure}[b]{0.49\textwidth}
	 		\centering
	 		\includegraphics[width=\textwidth]{lnn_scheme.png}
	 		\caption{Схема работы Lagrangian Neural Networks (LNN) моделирования динамики физической системы}
	 		\label{fig:three sin x}
	 	\end{subfigure}
	 \end{figure}

\end{frame}

%-----------------------------------------------------------------------------------------------------

\begin{frame}{Вычислительный эксперимент: Данные}
	Лагранжиан системы двойного маятника:
	$$
	\begin{aligned}
	L=\frac{1}{2}\left(m_{1}+m_{2}\right) l_{1}^{2} \dot{\theta}_{1}^{2} &+\frac{1}{2} m_{2} l_{2}^{2} \dot{\theta}_{2}^{2}+m_{2} l_{1} l_{2} \dot{\theta}_{1} \dot{\theta}_{2} \cos \left(\theta_{1}-\theta_{2}\right) \\
	&+\left(m_{1}+m_{2}\right) g l_{1} \cos \theta_{1}+m_{2} g l_{2} \cos \theta_{2}
	\end{aligned}
	$$
	\begin{figure}[H]
		\centering
		\begin{subfigure}[b]{0.49\textwidth}
			\centering
			\includegraphics[width=0.9\textwidth]{double_pendulum_scheme.png}
			\caption{Cхема физической системы двойного маятника}
			\label{fig:pendulum_system}
		\end{subfigure}
		\hfill
		\begin{subfigure}[b]{0.49\textwidth}
			\centering
			\includegraphics[width=0.9\textwidth]{data_field.png}
			\caption{Визуализация сгенерированных канонических координат системы двойного маятника}
		\end{subfigure}
	\end{figure}
\end{frame}

\begin{frame}{Вычислительный эксперимент}
\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{0.49\textwidth}
		\centering
		\includegraphics[width=0.7\textwidth]{analytical_pendulum.png}
		\caption{Динамика системы, аналитическое решение}
		\label{fig:y equals x}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.49\textwidth}
		\centering
		\includegraphics[width=0.7\textwidth]{fc_pendulum.png}
		\caption{Динамика системы, полносвязная нейронной сети}
		\label{fig:three sin x}
	\end{subfigure}
	\hfill
	\vfill
	\begin{subfigure}[b]{0.49\textwidth}
		\centering
		\includegraphics[width=0.7\textwidth]{lstm_pendulum.png}
		\caption{Динамика системы, LSTM}
		\label{fig:three sin x}
	\end{subfigure}
	\hfill
	\begin{subfigure}[b]{0.49\textwidth}
		\centering
		\includegraphics[width=0.7\textwidth]{lnn_pendulum.png}
		\caption{Динамика системы, LNN}
		\label{fig:five over x}
	\end{subfigure}
	\caption{Моделирование динамики системы двойного маятника различными видами нейронных сетей: аналитическое решение, полносвязная нейронная сеть, LSTM, LNN.}
	\label{fig:three graphs}
\end{figure}
	
\end{frame}

%------------------------------------------------------------------------------------------------
\begin{frame}{Будущая работа}
	\begin{itemize}
		\item Добавить в сравнение модели SSA и Neural ODE, 
		\item Добавить в сравнение модифицированную модель LNN, учитывающую трансляционную и вращательную симметрии.
	\end{itemize}

	\hfill
	%\begin{block}{Опубликованные работы}
	%	\textit{Котлярова Е.В., Северилов П.А., Ивченков Я.П., Мокров П.В., Чеканов М.О., Гасникова Е.В., Шароватова Ю.И}. Ускорение работы двухстадийной модели равновесного распределения потоков по сети / Компьютерные исследования и моделирование (том 14), 2022
	%\end{block}
\end{frame}


\end{document} 
